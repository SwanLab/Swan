classdef Hexahedra_Quadratic < Interpolation

    methods (Access = public)

        function obj = Hexahedra_Quadratic(cParams)
            obj.init(cParams);
            obj.computeParams();
        end

        function shape = computeShapeFunctions(obj,posgp)
            ngaus = size(posgp,2);
            nelem = size(posgp,3);
            shape = zeros(obj.nnode,ngaus,nelem);

            s = posgp(1,:,:);
            t = posgp(2,:,:);
            u = posgp(3,:,:);
            shape(1,:,:) = (s.*t.*u.^2)./8.0+(s.*t.^2.*u)./8.0+(s.^2.*t.*u)./8.0-(s.*t.^2.*u.^2)./8.0-(s.^2.*t.*u.^2)./8.0-(s.^2.*t.^2.*u)./8.0-(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(2,:,:) = s.*t.*u.^2.*(-1.0./8.0)-(s.*t.^2.*u)./8.0+(s.^2.*t.*u)./8.0+(s.*t.^2.*u.^2)./8.0-(s.^2.*t.*u.^2)./8.0-(s.^2.*t.^2.*u)./8.0+(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(3,:,:) = (s.*t.*u.^2)./8.0-(s.*t.^2.*u)./8.0-(s.^2.*t.*u)./8.0+(s.*t.^2.*u.^2)./8.0+(s.^2.*t.*u.^2)./8.0-(s.^2.*t.^2.*u)./8.0-(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(4,:,:) = s.*t.*u.^2.*(-1.0./8.0)+(s.*t.^2.*u)./8.0-(s.^2.*t.*u)./8.0-(s.*t.^2.*u.^2)./8.0+(s.^2.*t.*u.^2)./8.0-(s.^2.*t.^2.*u)./8.0+(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(5,:,:) = (s.*t.*u.^2)./8.0-(s.*t.^2.*u)./8.0-(s.^2.*t.*u)./8.0-(s.*t.^2.*u.^2)./8.0-(s.^2.*t.*u.^2)./8.0+(s.^2.*t.^2.*u)./8.0+(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(6,:,:) = s.*t.*u.^2.*(-1.0./8.0)+(s.*t.^2.*u)./8.0-(s.^2.*t.*u)./8.0+(s.*t.^2.*u.^2)./8.0-(s.^2.*t.*u.^2)./8.0+(s.^2.*t.^2.*u)./8.0-(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(7,:,:) = (s.*t.*u.^2)./8.0+(s.*t.^2.*u)./8.0+(s.^2.*t.*u)./8.0+(s.*t.^2.*u.^2)./8.0+(s.^2.*t.*u.^2)./8.0+(s.^2.*t.^2.*u)./8.0+(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(8,:,:) = s.*t.*u.^2.*(-1.0./8.0)-(s.*t.^2.*u)./8.0+(s.^2.*t.*u)./8.0-(s.*t.^2.*u.^2)./8.0+(s.^2.*t.*u.^2)./8.0+(s.^2.*t.^2.*u)./8.0-(s.*t.*u)./8.0+(s.^2.*t.^2.*u.^2)./8.0;
            shape(9,:,:) = (t.^2.*u.^2)./4.0+(t.*u)./4.0-(t.*u.^2)./4.0-(t.^2.*u)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0+(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(10,:,:) = (s.^2.*u.^2)./4.0+(s.*u)./4.0-(s.*u.^2)./4.0-(s.^2.*u)./4.0-(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0+(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(11,:,:) = (s.^2.*t.^2)./4.0+(s.*t)./4.0-(s.*t.^2)./4.0-(s.^2.*t)./4.0-(s.*t.*u.^2)./4.0+(s.*t.^2.*u.^2)./4.0+(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(12,:,:) = (s.^2.*u.^2)./4.0-(s.*u)./4.0+(s.*u.^2)./4.0-(s.^2.*u)./4.0+(s.*t.^2.*u)./4.0-(s.*t.^2.*u.^2)./4.0+(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(13,:,:) = (s.^2.*t.^2)./4.0-(s.*t)./4.0+(s.*t.^2)./4.0-(s.^2.*t)./4.0+(s.*t.*u.^2)./4.0-(s.*t.^2.*u.^2)./4.0+(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(14,:,:) = (t.^2.*u.^2)./4.0-(t.*u)./4.0+(t.*u.^2)./4.0-(t.^2.*u)./4.0+(s.^2.*t.*u)./4.0-(s.^2.*t.*u.^2)./4.0+(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(15,:,:) = (s.^2.*t.^2)./4.0+(s.*t)./4.0+(s.*t.^2)./4.0+(s.^2.*t)./4.0-(s.*t.*u.^2)./4.0-(s.*t.^2.*u.^2)./4.0-(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(16,:,:) = (s.^2.*t.^2)./4.0-(s.*t)./4.0-(s.*t.^2)./4.0+(s.^2.*t)./4.0+(s.*t.*u.^2)./4.0+(s.*t.^2.*u.^2)./4.0-(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(17,:,:) = (t.^2.*u.^2)./4.0-(t.*u)./4.0-(t.*u.^2)./4.0+(t.^2.*u)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(18,:,:) = (s.^2.*u.^2)./4.0-(s.*u)./4.0-(s.*u.^2)./4.0+(s.^2.*u)./4.0+(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0-(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(19,:,:) = (s.^2.*u.^2)./4.0+(s.*u)./4.0+(s.*u.^2)./4.0+(s.^2.*u)./4.0-(s.*t.^2.*u)./4.0-(s.*t.^2.*u.^2)./4.0-(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(20,:,:) = (t.^2.*u.^2)./4.0+(t.*u)./4.0+(t.*u.^2)./4.0+(t.^2.*u)./4.0-(s.^2.*t.*u)./4.0-(s.^2.*t.*u.^2)./4.0-(s.^2.*t.^2.*u)./4.0-(s.^2.*t.^2.*u.^2)./4.0;
            shape(21,:,:) = u.*(-1.0./2.0)-(s.^2.*u.^2)./2.0-(t.^2.*u.^2)./2.0+(s.^2.*u)./2.0+(t.^2.*u)./2.0+u.^2./2.0-(s.^2.*t.^2.*u)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(22,:,:) = t.*(-1.0./2.0)-(s.^2.*t.^2)./2.0-(t.^2.*u.^2)./2.0+(s.^2.*t)./2.0+(t.*u.^2)./2.0+t.^2./2.0-(s.^2.*t.*u.^2)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(23,:,:) = s.*(-1.0./2.0)-(s.^2.*t.^2)./2.0-(s.^2.*u.^2)./2.0+(s.*t.^2)./2.0+(s.*u.^2)./2.0+s.^2./2.0-(s.*t.^2.*u.^2)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(24,:,:) = s./2.0-(s.^2.*t.^2)./2.0-(s.^2.*u.^2)./2.0-(s.*t.^2)./2.0-(s.*u.^2)./2.0+s.^2./2.0+(s.*t.^2.*u.^2)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(25,:,:) = t./2.0-(s.^2.*t.^2)./2.0-(t.^2.*u.^2)./2.0-(s.^2.*t)./2.0-(t.*u.^2)./2.0+t.^2./2.0+(s.^2.*t.*u.^2)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(26,:,:) = u./2.0-(s.^2.*u.^2)./2.0-(t.^2.*u.^2)./2.0-(s.^2.*u)./2.0-(t.^2.*u)./2.0+u.^2./2.0+(s.^2.*t.^2.*u)./2.0+(s.^2.*t.^2.*u.^2)./2.0;
            shape(27,:,:) = s.^2.*t.^2+s.^2.*u.^2+t.^2.*u.^2-s.^2-t.^2-u.^2-s.^2.*t.^2.*u.^2+1.0;
        end

        function deriv = computeShapeDerivatives(obj,posgp)
            ngaus = size(posgp,2);
            nelem = size(posgp,3);
            deriv = zeros(obj.ndime,obj.nnode,ngaus,nelem);

            s=posgp(1,:,:);
            t=posgp(2,:,:);
            u=posgp(3,:,:);
            deriv(1,1,:,:) = t.^2.*u.^2.*(-1.0./8.0)-(t.*u)./8.0+(t.*u.^2)./8.0+(t.^2.*u)./8.0-(s.*t.*u.^2)./4.0-(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(1,2,:,:) = (s.*t.*u.^2)./2.0+(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0-(s.*t.*u)./2.0;
            deriv(1,3,:,:) = (t.^2.*u.^2)./8.0+(t.*u)./8.0-(t.*u.^2)./8.0-(t.^2.*u)./8.0-(s.*t.*u.^2)./4.0-(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(1,4,:,:) = u./4.0+(t.^2.*u.^2)./4.0-(s.*u)./2.0+(s.*u.^2)./2.0-(t.^2.*u)./4.0-u.^2./4.0+(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,5,:,:) = s.*u-s.*u.^2-s.*t.^2.*u+s.*t.^2.*u.^2;
            deriv(1,6,:,:) = u.*(-1.0./4.0)-(t.^2.*u.^2)./4.0-(s.*u)./2.0+(s.*u.^2)./2.0+(t.^2.*u)./4.0+u.^2./4.0+(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,7,:,:) = t.^2.*u.^2.*(-1.0./8.0)+(t.*u)./8.0-(t.*u.^2)./8.0+(t.^2.*u)./8.0+(s.*t.*u.^2)./4.0-(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(1,8,:,:) = s.*t.*u.^2.*(-1.0./2.0)+(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0+(s.*t.*u)./2.0;
            deriv(1,9,:,:) = (t.^2.*u.^2)./8.0-(t.*u)./8.0+(t.*u.^2)./8.0-(t.^2.*u)./8.0+(s.*t.*u.^2)./4.0-(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(1,10,:,:) = t./4.0+(t.^2.*u.^2)./4.0-(s.*t)./2.0+(s.*t.^2)./2.0-(t.*u.^2)./4.0-t.^2./4.0+(s.*t.*u.^2)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,11,:,:) = s.*t-s.*t.^2-s.*t.*u.^2+s.*t.^2.*u.^2;
            deriv(1,12,:,:) = t.*(-1.0./4.0)-(t.^2.*u.^2)./4.0-(s.*t)./2.0+(s.*t.^2)./2.0+(t.*u.^2)./4.0+t.^2./4.0+(s.*t.*u.^2)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,13,:,:) = s-(t.^2.*u.^2)./2.0-s.*t.^2-s.*u.^2+t.^2./2.0+u.^2./2.0+s.*t.^2.*u.^2-1.0./2.0;
            deriv(1,14,:,:) = s.*-2.0+s.*t.^2.*2.0+s.*u.^2.*2.0-s.*t.^2.*u.^2.*2.0;
            deriv(1,15,:,:) = s+(t.^2.*u.^2)./2.0-s.*t.^2-s.*u.^2-t.^2./2.0-u.^2./2.0+s.*t.^2.*u.^2+1.0./2.0;
            deriv(1,16,:,:) = t.*(-1.0./4.0)+(t.^2.*u.^2)./4.0+(s.*t)./2.0+(s.*t.^2)./2.0+(t.*u.^2)./4.0-t.^2./4.0-(s.*t.*u.^2)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,17,:,:) = -s.*t-s.*t.^2+s.*t.*u.^2+s.*t.^2.*u.^2;
            deriv(1,18,:,:) = t./4.0-(t.^2.*u.^2)./4.0+(s.*t)./2.0+(s.*t.^2)./2.0-(t.*u.^2)./4.0+t.^2./4.0-(s.*t.*u.^2)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,19,:,:) = t.^2.*u.^2.*(-1.0./8.0)+(t.*u)./8.0+(t.*u.^2)./8.0-(t.^2.*u)./8.0-(s.*t.*u.^2)./4.0+(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(1,20,:,:) = (s.*t.*u.^2)./2.0-(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0+(s.*t.*u)./2.0;
            deriv(1,21,:,:) = (t.^2.*u.^2)./8.0-(t.*u)./8.0-(t.*u.^2)./8.0+(t.^2.*u)./8.0-(s.*t.*u.^2)./4.0+(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(1,22,:,:) = u.*(-1.0./4.0)+(t.^2.*u.^2)./4.0+(s.*u)./2.0+(s.*u.^2)./2.0+(t.^2.*u)./4.0-u.^2./4.0-(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,23,:,:) = -s.*u-s.*u.^2+s.*t.^2.*u+s.*t.^2.*u.^2;
            deriv(1,24,:,:) = u./4.0-(t.^2.*u.^2)./4.0+(s.*u)./2.0+(s.*u.^2)./2.0-(t.^2.*u)./4.0+u.^2./4.0-(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0;
            deriv(1,25,:,:) = t.^2.*u.^2.*(-1.0./8.0)-(t.*u)./8.0-(t.*u.^2)./8.0-(t.^2.*u)./8.0+(s.*t.*u.^2)./4.0+(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(1,26,:,:) = s.*t.*u.^2.*(-1.0./2.0)-(s.*t.^2.*u)./2.0-(s.*t.^2.*u.^2)./2.0-(s.*t.*u)./2.0;
            deriv(1,27,:,:) = (t.^2.*u.^2)./8.0+(t.*u)./8.0+(t.*u.^2)./8.0+(t.^2.*u)./8.0+(s.*t.*u.^2)./4.0+(s.*t.^2.*u)./4.0+(s.*t.^2.*u.^2)./4.0+(s.*t.*u)./4.0;

            deriv(2,1,:,:) = s.^2.*u.^2.*(-1.0./8.0)-(s.*u)./8.0+(s.*u.^2)./8.0+(s.^2.*u)./8.0-(s.*t.*u.^2)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(2,2,:,:) = u./4.0+(s.^2.*u.^2)./4.0-(t.*u)./2.0-(s.^2.*u)./4.0+(t.*u.^2)./2.0-u.^2./4.0+(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,3,:,:) = s.^2.*u.^2.*(-1.0./8.0)+(s.*u)./8.0-(s.*u.^2)./8.0+(s.^2.*u)./8.0+(s.*t.*u.^2)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(2,4,:,:) = (s.*t.*u.^2)./2.0+(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0-(s.*t.*u)./2.0;
            deriv(2,5,:,:) = t.*u-t.*u.^2-s.^2.*t.*u+s.^2.*t.*u.^2;
            deriv(2,6,:,:) = s.*t.*u.^2.*(-1.0./2.0)+(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0+(s.*t.*u)./2.0;
            deriv(2,7,:,:) = (s.^2.*u.^2)./8.0+(s.*u)./8.0-(s.*u.^2)./8.0-(s.^2.*u)./8.0-(s.*t.*u.^2)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(2,8,:,:) = u.*(-1.0./4.0)-(s.^2.*u.^2)./4.0-(t.*u)./2.0+(s.^2.*u)./4.0+(t.*u.^2)./2.0+u.^2./4.0+(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,9,:,:) = (s.^2.*u.^2)./8.0-(s.*u)./8.0+(s.*u.^2)./8.0-(s.^2.*u)./8.0+(s.*t.*u.^2)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(2,10,:,:) = s./4.0+(s.^2.*u.^2)./4.0-(s.*t)./2.0+(s.^2.*t)./2.0-(s.*u.^2)./4.0-s.^2./4.0+(s.*t.*u.^2)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,11,:,:) = t-(s.^2.*u.^2)./2.0-s.^2.*t-t.*u.^2+s.^2./2.0+u.^2./2.0+s.^2.*t.*u.^2-1.0./2.0;
            deriv(2,12,:,:) = s.*(-1.0./4.0)+(s.^2.*u.^2)./4.0+(s.*t)./2.0+(s.^2.*t)./2.0+(s.*u.^2)./4.0-s.^2./4.0-(s.*t.*u.^2)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,13,:,:) = s.*t-s.^2.*t-s.*t.*u.^2+s.^2.*t.*u.^2;
            deriv(2,14,:,:) = t.*-2.0+s.^2.*t.*2.0+t.*u.^2.*2.0-s.^2.*t.*u.^2.*2.0;
            deriv(2,15,:,:) = -s.*t-s.^2.*t+s.*t.*u.^2+s.^2.*t.*u.^2;
            deriv(2,16,:,:) = s.*(-1.0./4.0)-(s.^2.*u.^2)./4.0-(s.*t)./2.0+(s.^2.*t)./2.0+(s.*u.^2)./4.0+s.^2./4.0+(s.*t.*u.^2)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,17,:,:) = t+(s.^2.*u.^2)./2.0-s.^2.*t-t.*u.^2-s.^2./2.0-u.^2./2.0+s.^2.*t.*u.^2+1.0./2.0;
            deriv(2,18,:,:) = s./4.0-(s.^2.*u.^2)./4.0+(s.*t)./2.0+(s.^2.*t)./2.0-(s.*u.^2)./4.0+s.^2./4.0-(s.*t.*u.^2)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,19,:,:) = s.^2.*u.^2.*(-1.0./8.0)+(s.*u)./8.0+(s.*u.^2)./8.0-(s.^2.*u)./8.0-(s.*t.*u.^2)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(2,20,:,:) = u.*(-1.0./4.0)+(s.^2.*u.^2)./4.0+(t.*u)./2.0+(s.^2.*u)./4.0+(t.*u.^2)./2.0-u.^2./4.0-(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,21,:,:) = s.^2.*u.^2.*(-1.0./8.0)-(s.*u)./8.0-(s.*u.^2)./8.0-(s.^2.*u)./8.0+(s.*t.*u.^2)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0+(s.*t.*u)./4.0;
            deriv(2,22,:,:) = (s.*t.*u.^2)./2.0-(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0+(s.*t.*u)./2.0;
            deriv(2,23,:,:) = -t.*u-t.*u.^2+s.^2.*t.*u+s.^2.*t.*u.^2;
            deriv(2,24,:,:) = s.*t.*u.^2.*(-1.0./2.0)-(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0-(s.*t.*u)./2.0;
            deriv(2,25,:,:) = (s.^2.*u.^2)./8.0-(s.*u)./8.0-(s.*u.^2)./8.0+(s.^2.*u)./8.0-(s.*t.*u.^2)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0-(s.*t.*u)./4.0;
            deriv(2,26,:,:) = u./4.0-(s.^2.*u.^2)./4.0+(t.*u)./2.0-(s.^2.*u)./4.0+(t.*u.^2)./2.0+u.^2./4.0-(s.^2.*t.*u)./2.0-(s.^2.*t.*u.^2)./2.0;
            deriv(2,27,:,:) = (s.^2.*u.^2)./8.0+(s.*u)./8.0+(s.*u.^2)./8.0+(s.^2.*u)./8.0+(s.*t.*u.^2)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.*u.^2)./4.0+(s.*t.*u)./4.0;

            deriv(3,1,:,:) = s.^2.*t.^2.*(-1.0./8.0)-(s.*t)./8.0+(s.*t.^2)./8.0+(s.^2.*t)./8.0-(s.*t.^2.*u)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0+(s.*t.*u)./4.0;
            deriv(3,2,:,:) = t./4.0+(s.^2.*t.^2)./4.0-(t.*u)./2.0-(s.^2.*t)./4.0+(t.^2.*u)./2.0-t.^2./4.0+(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,3,:,:) = s.^2.*t.^2.*(-1.0./8.0)+(s.*t)./8.0-(s.*t.^2)./8.0+(s.^2.*t)./8.0+(s.*t.^2.*u)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0-(s.*t.*u)./4.0;
            deriv(3,4,:,:) = s./4.0+(s.^2.*t.^2)./4.0-(s.*u)./2.0-(s.*t.^2)./4.0+(s.^2.*u)./2.0-s.^2./4.0+(s.*t.^2.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,5,:,:) = u-(s.^2.*t.^2)./2.0-s.^2.*u-t.^2.*u+s.^2./2.0+t.^2./2.0+s.^2.*t.^2.*u-1.0./2.0;
            deriv(3,6,:,:) = s.*(-1.0./4.0)+(s.^2.*t.^2)./4.0+(s.*u)./2.0+(s.*t.^2)./4.0+(s.^2.*u)./2.0-s.^2./4.0-(s.*t.^2.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,7,:,:) = s.^2.*t.^2.*(-1.0./8.0)+(s.*t)./8.0+(s.*t.^2)./8.0-(s.^2.*t)./8.0-(s.*t.^2.*u)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0-(s.*t.*u)./4.0;
            deriv(3,8,:,:) = t.*(-1.0./4.0)+(s.^2.*t.^2)./4.0+(t.*u)./2.0+(s.^2.*t)./4.0+(t.^2.*u)./2.0-t.^2./4.0-(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,9,:,:) = s.^2.*t.^2.*(-1.0./8.0)-(s.*t)./8.0-(s.*t.^2)./8.0-(s.^2.*t)./8.0+(s.*t.^2.*u)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0+(s.*t.*u)./4.0;
            deriv(3,10,:,:) = (s.*t.^2.*u)./2.0+(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0-(s.*t.*u)./2.0;
            deriv(3,11,:,:) = t.*u-t.^2.*u-s.^2.*t.*u+s.^2.*t.^2.*u;
            deriv(3,12,:,:) = s.*t.^2.*u.*(-1.0./2.0)+(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0+(s.*t.*u)./2.0;
            deriv(3,13,:,:) = s.*u-s.^2.*u-s.*t.^2.*u+s.^2.*t.^2.*u;
            deriv(3,14,:,:) = u.*-2.0+s.^2.*u.*2.0+t.^2.*u.*2.0-s.^2.*t.^2.*u.*2.0;
            deriv(3,15,:,:) = -s.*u-s.^2.*u+s.*t.^2.*u+s.^2.*t.^2.*u;
            deriv(3,16,:,:) = (s.*t.^2.*u)./2.0-(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0+(s.*t.*u)./2.0;
            deriv(3,17,:,:) = -t.*u-t.^2.*u+s.^2.*t.*u+s.^2.*t.^2.*u;
            deriv(3,18,:,:) = s.*t.^2.*u.*(-1.0./2.0)-(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0-(s.*t.*u)./2.0;
            deriv(3,19,:,:) = (s.^2.*t.^2)./8.0+(s.*t)./8.0-(s.*t.^2)./8.0-(s.^2.*t)./8.0-(s.*t.^2.*u)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0+(s.*t.*u)./4.0;
            deriv(3,20,:,:) = t.*(-1.0./4.0)-(s.^2.*t.^2)./4.0-(t.*u)./2.0+(s.^2.*t)./4.0+(t.^2.*u)./2.0+t.^2./4.0+(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,21,:,:) = (s.^2.*t.^2)./8.0-(s.*t)./8.0+(s.*t.^2)./8.0-(s.^2.*t)./8.0+(s.*t.^2.*u)./4.0-(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0-(s.*t.*u)./4.0;
            deriv(3,22,:,:) = s.*(-1.0./4.0)-(s.^2.*t.^2)./4.0-(s.*u)./2.0+(s.*t.^2)./4.0+(s.^2.*u)./2.0+s.^2./4.0+(s.*t.^2.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,23,:,:) = u+(s.^2.*t.^2)./2.0-s.^2.*u-t.^2.*u-s.^2./2.0-t.^2./2.0+s.^2.*t.^2.*u+1.0./2.0;
            deriv(3,24,:,:) = s./4.0-(s.^2.*t.^2)./4.0+(s.*u)./2.0-(s.*t.^2)./4.0+(s.^2.*u)./2.0+s.^2./4.0-(s.*t.^2.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,25,:,:) = (s.^2.*t.^2)./8.0-(s.*t)./8.0-(s.*t.^2)./8.0+(s.^2.*t)./8.0-(s.*t.^2.*u)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0-(s.*t.*u)./4.0;
            deriv(3,26,:,:) = t./4.0-(s.^2.*t.^2)./4.0+(t.*u)./2.0-(s.^2.*t)./4.0+(t.^2.*u)./2.0+t.^2./4.0-(s.^2.*t.*u)./2.0-(s.^2.*t.^2.*u)./2.0;
            deriv(3,27,:,:) = (s.^2.*t.^2)./8.0+(s.*t)./8.0+(s.*t.^2)./8.0+(s.^2.*t)./8.0+(s.*t.^2.*u)./4.0+(s.^2.*t.*u)./4.0+(s.^2.*t.^2.*u)./4.0+(s.*t.*u)./4.0;
        end

    end

    methods (Access = private)

        function computeParams(obj)
            obj.ndime = 3;
            obj.nnode = 27;
            % obj.isoDv = 8;
            obj.pos_nodes=[-1 -1 -1;
                +1   -1   -1;
                +1   +1   -1;
                -1   +1   -1;
                -1   -1   +1;
                +1   -1   +1;
                +1   +1   +1;
                -1   +1   +1;
                +0   -1   -1;
                -1   +0   -1;
                -1   -1   +0;
                +1   +0   -1;
                +1   -1   +0;
                +0   +1   -1;
                +1   +1   +0;
                -1   +1   +0;
                +0   -1   +1;
                -1   +0   +1;
                +1   +0   +1;
                +0   +1   +1;
                +0   +0   -1;
                +0   -1   +0;
                -1   +0   +0;
                +1   +0   +0;
                +0   +1   +0;
                +0   +0   +1;
                +0   +0   +0];
        end

    end

end
