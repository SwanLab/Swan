classdef TetrahedraCubic < Interpolation
    
    methods (Access = public)
        
        function obj = TetrahedraCubic(cParams)
            obj.init(cParams);
        end
        
    end
    
    methods (Access = protected)
        
        function computeParams(obj)
            obj.ndime = 3;
            obj.nnode = 20;
            obj.pos_nodes = [0   0   0;
                1   0   0;
                0   1   0;
                0   0   1;
                1/3 0   0;
                2/3 0   0;
                0   1/3 0;
                0   2/3 0;
                0   0   1/3;
                0   0   2/3;
                2/3 1/3 0;
                1/3 2/3 0;
                2/3 0   1/3;
                1/3 0   2/3;
                0   2/3 1/3;
                0   1/3 2/3;
                0   1/3 1/3;
                1/3 0   1/3;
                1/3 1/3 0;
                1/3 1/3 1/3];
            % obj.isoDv = 1/6;
        end

        function shape = evaluateShapeFunctions(obj,xV)
            ngaus = size(xV,2);
            nelem = size(xV,3);
            s = xV(1,:,:);
            t = xV(2,:,:);
            u = xV(3,:,:);
            shape = zeros(obj.nnode,ngaus,nelem);
            shape(1,:,:)  = s.*(-1.1e+1./2.0)-t.*(1.1e+1./2.0)-u.*(1.1e+1./2.0)+s.*t.*1.8e+1+s.*u.*1.8e+1+t.*u.*1.8e+1-s.*t.^2.*(2.7e+1./2.0)-s.^2.*t.*(2.7e+1./2.0)-s.*u.^2.*(2.7e+1./2.0)-s.^2.*u.*(2.7e+1./2.0)-t.*u.^2.*(2.7e+1./2.0)-t.^2.*u.*(2.7e+1./2.0)+s.^2.*9.0-s.^3.*(9.0./2.0)+t.^2.*9.0-t.^3.*(9.0./2.0)+u.^2.*9.0-u.^3.*(9.0./2.0)-s.*t.*u.*2.7e+1+1.0;
            shape(2,:,:)  = s-s.^2.*(9.0./2.0)+s.^3.*(9.0./2.0);
            shape(3,:,:)  = t-t.^2.*(9.0./2.0)+t.^3.*(9.0./2.0);
            shape(4,:,:)  = u-u.^2.*(9.0./2.0)+u.^3.*(9.0./2.0);
            shape(5,:,:)  = s.*9.0-s.*t.*(4.5e+1./2.0)-s.*u.*(4.5e+1./2.0)+s.*t.^2.*(2.7e+1./2.0)+s.^2.*t.*2.7e+1+s.*u.^2.*(2.7e+1./2.0)+s.^2.*u.*2.7e+1-s.^2.*(4.5e+1./2.0)+s.^3.*(2.7e+1./2.0)+s.*t.*u.*2.7e+1;
            shape(6,:,:)  = s.*(-9.0./2.0)+s.*t.*(9.0./2.0)+s.*u.*(9.0./2.0)-s.^2.*t.*(2.7e+1./2.0)-s.^2.*u.*(2.7e+1./2.0)+s.^2.*1.8e+1-s.^3.*(2.7e+1./2.0);
            shape(7,:,:)  = t.*9.0-s.*t.*(4.5e+1./2.0)-t.*u.*(4.5e+1./2.0)+s.*t.^2.*2.7e+1+s.^2.*t.*(2.7e+1./2.0)+t.*u.^2.*(2.7e+1./2.0)+t.^2.*u.*2.7e+1-t.^2.*(4.5e+1./2.0)+t.^3.*(2.7e+1./2.0)+s.*t.*u.*2.7e+1;
            shape(8,:,:)  = t.*(-9.0./2.0)+s.*t.*(9.0./2.0)+t.*u.*(9.0./2.0)-s.*t.^2.*(2.7e+1./2.0)-t.^2.*u.*(2.7e+1./2.0)+t.^2.*1.8e+1-t.^3.*(2.7e+1./2.0);
            shape(9,:,:)  = u.*9.0-s.*u.*(4.5e+1./2.0)-t.*u.*(4.5e+1./2.0)+s.*u.^2.*2.7e+1+s.^2.*u.*(2.7e+1./2.0)+t.*u.^2.*2.7e+1+t.^2.*u.*(2.7e+1./2.0)-u.^2.*(4.5e+1./2.0)+u.^3.*(2.7e+1./2.0)+s.*t.*u.*2.7e+1;
            shape(10,:,:) = u.*(-9.0./2.0)+s.*u.*(9.0./2.0)+t.*u.*(9.0./2.0)-s.*u.^2.*(2.7e+1./2.0)-t.*u.^2.*(2.7e+1./2.0)+u.^2.*1.8e+1-u.^3.*(2.7e+1./2.0);
            
            shape(11,:,:) = s.*t.*(-9.0./2.0)+s.^2.*t.*(2.7e+1./2.0);
            shape(12,:,:) = s.*t.*(-9.0./2.0)+s.*t.^2.*(2.7e+1./2.0);
            
            shape(13,:,:) = s.*u.*(-9.0./2.0)+s.^2.*u.*(2.7e+1./2.0);
            shape(14,:,:) = s.*u.*(-9.0./2.0)+s.*u.^2.*(2.7e+1./2.0);
            
            shape(15,:,:) = t.*u.*(-9.0./2.0)+t.^2.*u.*(2.7e+1./2.0);
            shape(16,:,:) = t.*u.*(-9.0./2.0)+t.*u.^2.*(2.7e+1./2.0);
            shape(17,:,:) = t.*u.*2.7e+1-t.*u.^2.*2.7e+1-t.^2.*u.*2.7e+1-s.*t.*u.*2.7e+1;
            shape(18,:,:) = s.*u.*2.7e+1-s.*u.^2.*2.7e+1-s.^2.*u.*2.7e+1-s.*t.*u.*2.7e+1;
            shape(19,:,:) = s.*t.*2.7e+1-s.*t.^2.*2.7e+1-s.^2.*t.*2.7e+1-s.*t.*u.*2.7e+1;
            shape(20,:,:) = s.*t.*u.*2.7e+1;
        end

        function deriv = evaluateShapeDerivatives(obj,xV)
            ngaus = size(xV,2);
            nelem = size(xV,3);
            s = xV(1,:,:);
            t = xV(2,:,:);
            u = xV(3,:,:);
            deriv = zeros(obj.ndime,obj.nnode,ngaus,nelem);
            deriv(1,1,:,:)  = s.*1.8e+1+t.*1.8e+1+u.*1.8e+1-s.*t.*2.7e+1-s.*u.*2.7e+1-t.*u.*2.7e+1-s.^2.*(2.7e+1./2.0)-t.^2.*(2.7e+1./2.0)-u.^2.*(2.7e+1./2.0)-1.1e+1./2.0;
            deriv(1,2,:,:)  = s.*-9.0+s.^2.*(2.7e+1./2.0)+1.0;
            deriv(1,3,:,:)  = 0;
            deriv(1,4,:,:)  = 0;
            deriv(1,5,:,:)  = s.*-4.5e+1-t.*(4.5e+1./2.0)-u.*(4.5e+1./2.0)+s.*t.*5.4e+1+s.*u.*5.4e+1+t.*u.*2.7e+1+s.^2.*(8.1e+1./2.0)+t.^2.*(2.7e+1./2.0)+u.^2.*(2.7e+1./2.0)+9.0;
            deriv(1,6,:,:)  = t.*(-9.0./2.0)+t.^2.*(2.7e+1./2.0);
            deriv(1,7,:,:)  = t.*(-4.5e+1./2.0)+s.*t.*2.7e+1+t.*u.*2.7e+1+t.^2.*2.7e+1;
            deriv(1,8,:,:)  = t.*(9.0./2.0)-t.^2.*(2.7e+1./2.0);
            deriv(1,9,:,:)  = u.*(-4.5e+1./2.0)+s.*u.*2.7e+1+t.*u.*2.7e+1+u.^2.*2.7e+1;
            deriv(1,10,:,:) = u.*(9.0./2.0)-u.^2.*(2.7e+1./2.0);
            deriv(1,11,:,:) = t.*(-9.0./2.0)+s.*t.*2.7e+1;
            deriv(1,12,:,:) = t.*(-9.0./2.0)+t.^2.*(2.7e+1./2.0);
            deriv(1,13,:,:) = u.*(-9.0./2.0)+s.*u.*2.7e+1;
            deriv(1,14,:,:) = u.*(-9.0./2.0)+u.^2.*(2.7e+1./2.0);
            deriv(1,15,:,:) = 0;
            deriv(1,16,:,:) = 0;
            deriv(1,17,:,:) = t.*u.*-2.7e+1;
            deriv(1,18,:,:) = u.*2.7e+1-s.*u.*5.4e+1-t.*u.*2.7e+1-u.^2.*2.7e+1;
            deriv(1,19,:,:) = t.*2.7e+1-s.*t.*5.4e+1-t.*u.*2.7e+1-t.^2.*2.7e+1;
            deriv(1,20,:,:) = t.*u.*2.7e+1;
            
            deriv(2,1,:,:)  = s.*1.8e+1+t.*1.8e+1+u.*1.8e+1-s.*t.*2.7e+1-s.*u.*2.7e+1-t.*u.*2.7e+1-s.^2.*(2.7e+1./2.0)-t.^2.*(2.7e+1./2.0)-u.^2.*(2.7e+1./2.0)-1.1e+1./2.0;
            deriv(2,2,:,:)  = 0;
            deriv(2,3,:,:)  = t.*-9.0+t.^2.*(2.7e+1./2.0)+1.0;
            deriv(2,4,:,:)  = 0;
            deriv(2,5,:,:)  = s.*(-4.5e+1./2.0)+s.*t.*2.7e+1+s.*u.*2.7e+1+s.^2.*2.7e+1;
            deriv(2,6,:,:)  = s.*(-9.0./2.0)+s.*t.*2.7e+1;
            deriv(2,7,:,:)  = s.*(-4.5e+1./2.0)-t.*4.5e+1-u.*(4.5e+1./2.0)+s.*t.*5.4e+1+s.*u.*2.7e+1+t.*u.*5.4e+1+s.^2.*(2.7e+1./2.0)+t.^2.*(8.1e+1./2.0)+u.^2.*(2.7e+1./2.0)+9.0;
            deriv(2,8,:,:)  = s.*(9.0./2.0)+t.*3.6e+1+u.*(9.0./2.0)-s.*t.*2.7e+1-t.*u.*2.7e+1-t.^2.*(8.1e+1./2.0)-9.0./2.0;
            deriv(2,9,:,:)  = u.*(-4.5e+1./2.0)+s.*u.*2.7e+1+t.*u.*2.7e+1+u.^2.*2.7e+1;
            deriv(2,10,:,:) = u.*(9.0./2.0)-u.^2.*(2.7e+1./2.0);
            deriv(2,11,:,:) = s.*(-9.0./2.0)+s.^2.*(2.7e+1./2.0);
            deriv(2,12,:,:) = s.*(-9.0./2.0)+s.*t.*2.7e+1;
            deriv(2,13,:,:) = 0;
            deriv(2,14,:,:) = 0;
            deriv(2,15,:,:) = u.*(-9.0./2.0)+t.*u.*2.7e+1;
            deriv(2,16,:,:) = u.*(-9.0./2.0)+u.^2.*(2.7e+1./2.0);
            deriv(2,17,:,:) = u.*2.7e+1-s.*u.*2.7e+1-t.*u.*5.4e+1-u.^2.*2.7e+1;
            deriv(2,18,:,:) = s.*u.*-2.7e+1;
            deriv(2,19,:,:) = s.*2.7e+1-s.*t.*5.4e+1-s.*u.*2.7e+1-s.^2.*2.7e+1;
            deriv(2,20,:,:) = s.*u.*2.7e+1;
            
            deriv(3,1,:,:)  = s.*1.8e+1+t.*1.8e+1+u.*1.8e+1-s.*t.*2.7e+1-s.*u.*2.7e+1-t.*u.*2.7e+1-s.^2.*(2.7e+1./2.0)-t.^2.*(2.7e+1./2.0)-u.^2.*(2.7e+1./2.0)-1.1e+1./2.0;
            deriv(3,2,:,:)  = 0;
            deriv(3,3,:,:)  = 0;
            deriv(3,4,:,:)  = u.*-9.0+u.^2.*(2.7e+1./2.0)+1.0;
            deriv(3,5,:,:)  = s.*(-4.5e+1./2.0)+s.*t.*2.7e+1+s.*u.*2.7e+1+s.^2.*2.7e+1;
            deriv(3,6,:,:)  = 0;
            deriv(3,7,:,:)  = t.*(-4.5e+1./2.0)+s.*t.*2.7e+1+t.*u.*2.7e+1+t.^2.*2.7e+1;
            deriv(3,8,:,:)  = t.*(9.0./2.0)-15-t.^2.*(2.7e+1./2.0);
            deriv(3,9,:,:)  = s.*(-4.5e+1./2.0)-t.*(4.5e+1./2.0)-u.*4.5e+1+s.*t.*2.7e+1+s.*u.*5.4e+1+t.*u.*5.4e+1+s.^2.*(2.7e+1./2.0)+t.^2.*(2.7e+1./2.0)+u.^2.*(8.1e+1./2.0)+9.0;
            deriv(3,10,:,:) = s.*(9.0./2.0)+t.*(9.0./2.0)+u.*3.6e+1-s.*u.*2.7e+1-t.*u.*2.7e+1-u.^2.*(8.1e+1./2.0)-9.0./2.0;
            deriv(3,11,:,:) = 0;
            deriv(3,12,:,:) = 0;
            deriv(3,13,:,:) = s.*(-9.0./2.0)+s.^2.*(2.7e+1./2.0);
            deriv(3,14,:,:) = s.*(-9.0./2.0)+s.*u.*2.7e+1;
            deriv(3,15,:,:) = t.*(-9.0./2.0)+t.^2.*(2.7e+1./2.0);
            deriv(3,16,:,:) = t.*(-9.0./2.0)+t.*u.*2.7e+1;
            deriv(3,17,:,:) = t.*2.7e+1-s.*t.*2.7e+1-t.*u.*5.4e+1-t.^2.*2.7e+1;
            deriv(3,18,:,:) = s.*2.7e+1-s.*t.*2.7e+1-s.*u.*5.4e+1-s.^2.*2.7e+1;
            deriv(3,19,:,:) = s.*t.*-2.7e+1;
            deriv(3,20,:,:) = s.*t.*2.7e+1;
        end
        
    end
    
end
