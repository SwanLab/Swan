IMPORT "io.edp"
load "distance"

mesh Th = importMesh("Th");

/* Finite Element spaces */
fespace Vh(Th,P1);
fespace Vh0(Th,P0);

/* Initialization of the Level Set function */
func real initialGuess() {
  real x0 = 0, y0 = 0.5, lx = 1.5, ly = 0.4, p = 4, ls;
  ls = ((abs((x-x0)/lx)^p+abs((y-y0)/ly)^p)^(1/p)) - 0.5;
  return(ls);
}
Vh phio, phi;
phio = initialGuess();
distance(Th,phio,phi[]);

exportArray(phi[]);