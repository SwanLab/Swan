%==========================================================================
%                        General Data File
% Title: TRIANGLE
% Units: SI
% Dimensions: 2D
% Type of problem: Plane_Stress
% Type of Phisics: ELASTIC
% Micro/Macro: MACRO
%
%==========================================================================

%% Data

settings.ptype = 'MACRO';
settings.plotting = false;
settings.printing = false;
settings.monitoring = false;
settings.maxiter = 3;
settings.method = 'SIMP_Adaptative';
settings.material = 'ISOTROPIC';
settings.initial_case = 'square';
addpath(genpath('./Input'))
settings.cost = {'compliance';'perimeter'};
settings.weights = [1 0.1];
settings.constraint = {'volume'};

settings.optimizer = 'PROJECTED GRADIENT';
settings.kappaMultiplier = 1;

settings.filter = 'PDE';

settings.TOL.rho_plus = 1;
settings.TOL.rho_minus = 0;
settings.TOL.E_plus = 1;
settings.TOL.E_minus = 1e-3;
settings.TOL.nu_plus = 1/3;
settings.TOL.nu_minus = 1/3;

settings.target_parameters.Vfrac = 1;
settings.target_parameters.optimality_tol = 1e-3;
settings.target_parameters.constr_tol = 1e-3;
settings.Perimeter_target = 5;
settings.perimeter.optimizer = settings.optimizer;

settings.nsteps = 1;
settings.Vfrac_final = settings.target_parameters.Vfrac;
settings.optimality_final = settings.target_parameters.optimality_tol;
settings.constr_final = settings.target_parameters.constr_tol;
settings.Vfrac_initial = 1;

settings.optimality_initial = 1e-3;
settings.constr_initial = 1e-3;
settings.epsilon_initial=[];
% settings.epsilon_isotropy_initial=[];


Data_prb = {
'TRIANGLE';
'SI';
'2D';
'Plane_Stress';
'ELASTIC';
'MACRO';
};

%% Coordinates
% Node                X                Y                Z

coord = [
1.0000         0         0         0
    2.0000         0   -0.4000         0
    3.0000    0.1000   -0.4000         0
    4.0000    0.1000   -0.6000         0
    5.0000         0   -0.6000         0
    6.0000         0   -1.0000         0
    7.0000    1.0000   -1.0000         0
    8.0000    1.0000         0         0
    9.0000         0   -0.0500         0
   10.0000         0   -0.1000         0
   11.0000         0   -0.1500         0
   12.0000         0   -0.2000         0
   13.0000         0   -0.2500         0
   14.0000         0   -0.3000         0
   15.0000         0   -0.3500         0
   16.0000    0.0500   -0.4000         0
   17.0000    0.1000   -0.4500         0
   18.0000    0.1000   -0.5000         0
   19.0000    0.1000   -0.5500         0
   20.0000    0.0500   -0.6000         0
   21.0000         0   -0.6500         0
   22.0000         0   -0.7000         0
   23.0000         0   -0.7500         0
   24.0000         0   -0.8000         0
   25.0000         0   -0.8500         0
   26.0000         0   -0.9000         0
   27.0000         0   -0.9500         0
   28.0000    0.0500   -1.0000         0
   29.0000    0.1000   -1.0000         0
   30.0000    0.1500   -1.0000         0
   31.0000    0.2000   -1.0000         0
   32.0000    0.2500   -1.0000         0
   33.0000    0.3000   -1.0000         0
   34.0000    0.3500   -1.0000         0
   35.0000    0.4000   -1.0000         0
   36.0000    0.4500   -1.0000         0
   37.0000    0.5000   -1.0000         0
   38.0000    0.5500   -1.0000         0
   39.0000    0.6000   -1.0000         0
   40.0000    0.6500   -1.0000         0
   41.0000    0.7000   -1.0000         0
   42.0000    0.7500   -1.0000         0
   43.0000    0.8000   -1.0000         0
   44.0000    0.8500   -1.0000         0
   45.0000    0.9000   -1.0000         0
   46.0000    0.9500   -1.0000         0
   47.0000    1.0000   -0.9500         0
   48.0000    1.0000   -0.9000         0
   49.0000    1.0000   -0.8500         0
   50.0000    1.0000   -0.8000         0
   51.0000    1.0000   -0.7500         0
   52.0000    1.0000   -0.7000         0
   53.0000    1.0000   -0.6500         0
   54.0000    1.0000   -0.6000         0
   55.0000    1.0000   -0.5500         0
   56.0000    1.0000   -0.5000         0
   57.0000    1.0000   -0.4500         0
   58.0000    1.0000   -0.4000         0
   59.0000    1.0000   -0.3500         0
   60.0000    1.0000   -0.3000         0
   61.0000    1.0000   -0.2500         0
   62.0000    1.0000   -0.2000         0
   63.0000    1.0000   -0.1500         0
   64.0000    1.0000   -0.1000         0
   65.0000    1.0000   -0.0500         0
   66.0000    0.9500         0         0
   67.0000    0.9000         0         0
   68.0000    0.8500         0         0
   69.0000    0.8000         0         0
   70.0000    0.7500         0         0
   71.0000    0.7000         0         0
   72.0000    0.6500         0         0
   73.0000    0.6000         0         0
   74.0000    0.5500         0         0
   75.0000    0.5000         0         0
   76.0000    0.4500         0         0
   77.0000    0.4000         0         0
   78.0000    0.3500         0         0
   79.0000    0.3000         0         0
   80.0000    0.2500         0         0
   81.0000    0.2000         0         0
   82.0000    0.1500         0         0
   83.0000    0.1000         0         0
   84.0000    0.0500         0         0
   85.0000    0.4250   -0.9567         0
   86.0000    0.4750   -0.9567         0
   87.0000    0.3750   -0.9567         0
   88.0000    0.4000   -0.9134         0
   89.0000    0.4500   -0.9134         0
   90.0000    0.3500   -0.9134         0
   91.0000    0.3250   -0.9567         0
   92.0000    0.4250   -0.8701         0
   93.0000    0.3750   -0.8701         0
   94.0000    0.4750   -0.8701         0
   95.0000    0.5000   -0.9134         0
   96.0000    0.4500   -0.8268         0
   97.0000    0.5250   -0.8701         0
   98.0000    0.5000   -0.8268         0
   99.0000    0.5500   -0.9134         0
  100.0000    0.5750   -0.8701         0
  101.0000    0.6000   -0.9134         0
  102.0000    0.5500   -0.8268         0
  103.0000    0.5750   -0.9567         0
  104.0000    0.6000   -0.8268         0
  105.0000    0.5250   -0.9567         0
  106.0000    0.6250   -0.8701         0
  107.0000    0.5250   -0.7835         0
  108.0000    0.5750   -0.7835         0
  109.0000    0.6500   -0.9134         0
  110.0000    0.6250   -0.9567         0
  111.0000    0.6250   -0.7835         0
  112.0000    0.6500   -0.8268         0
  113.0000    0.6750   -0.9567         0
  114.0000    0.7250   -0.9567         0
  115.0000    0.7000   -0.9134         0
  116.0000    0.7750   -0.9567         0
  117.0000    0.7500   -0.9134         0
  118.0000    0.7250   -0.8701         0
  119.0000    0.8250   -0.9567         0
  120.0000    0.7750   -0.8701         0
  121.0000    0.6750   -0.8701         0
  122.0000    0.8000   -0.9134         0
  123.0000    0.7000   -0.8268         0
  124.0000    0.8750   -0.9567         0
  125.0000    0.7500   -0.8268         0
  126.0000    0.9292   -0.9556         0
  127.0000    0.8000   -0.8268         0
  128.0000    0.9000   -0.9134         0
  129.0000    0.8250   -0.8701         0
  130.0000    0.9500   -0.9134         0
  131.0000    0.9292   -0.8668         0
  132.0000    0.8500   -0.9134         0
  133.0000    0.8750   -0.8701         0
  134.0000    0.9000   -0.8268         0
  135.0000    0.9517   -0.8260         0
  136.0000    0.9292   -0.7862         0
  137.0000    0.8500   -0.8268         0
  138.0000    0.8750   -0.7835         0
  139.0000    0.9000   -0.7402         0
  140.0000    0.9500   -0.7402         0
  141.0000    0.8250   -0.7835         0
  142.0000    0.9250   -0.6969         0
  143.0000    0.8500   -0.7402         0
  144.0000    0.8750   -0.6969         0
  145.0000    0.9000   -0.6536         0
  146.0000    0.9500   -0.6536         0
  147.0000    0.8250   -0.6969         0
  148.0000    0.9292   -0.6086         0
  149.0000    0.8500   -0.6536         0
  150.0000    0.8000   -0.7402         0
  151.0000    0.8750   -0.6103         0
  152.0000    0.7750   -0.6969         0
  153.0000    0.9000   -0.5670         0
  154.0000    0.8000   -0.6536         0
  155.0000    0.7500   -0.7402         0
  156.0000    0.9500   -0.5670         0
  157.0000    0.8250   -0.6103         0
  158.0000    0.7250   -0.6969         0
  159.0000    0.8500   -0.5670         0
  160.0000    0.7500   -0.6536         0
  161.0000    0.7000   -0.7402         0
  162.0000    0.8000   -0.5670         0
  163.0000    0.6750   -0.6969         0
  164.0000    0.8250   -0.5237         0
  165.0000    0.7750   -0.6103         0
  166.0000    0.7000   -0.6536         0
  167.0000    0.6500   -0.7402         0
  168.0000    0.8750   -0.5237         0
  169.0000    0.7500   -0.5670         0
  170.0000    0.6250   -0.6969         0
  171.0000    0.7750   -0.5237         0
  172.0000    0.6500   -0.6536         0
  173.0000    0.6000   -0.7402         0
  174.0000    0.7250   -0.5237         0
  175.0000    0.5750   -0.6969         0
  176.0000    0.7500   -0.4804         0
  177.0000    0.7000   -0.5670         0
  178.0000    0.6000   -0.6536         0
  179.0000    0.5500   -0.7402         0
  180.0000    0.8000   -0.4804         0
  181.0000    0.6750   -0.5237         0
  182.0000    0.5250   -0.6969         0
  183.0000    0.7000   -0.4804         0
  184.0000    0.5500   -0.6536         0
  185.0000    0.5000   -0.7402         0
  186.0000    0.6500   -0.4804         0
  187.0000    0.4750   -0.6969         0
  188.0000    0.6750   -0.4371         0
  189.0000    0.6250   -0.5237         0
  190.0000    0.5000   -0.6536         0
  191.0000    0.4500   -0.7402         0
  192.0000    0.7250   -0.4371         0
  193.0000    0.6000   -0.4804         0
  194.0000    0.4250   -0.6969         0
  195.0000    0.6250   -0.4371         0
  196.0000    0.4500   -0.6536         0
  197.0000    0.4000   -0.7402         0
  198.0000    0.4250   -0.7835         0
  199.0000    0.4750   -0.6103         0
  200.0000    0.3750   -0.7835         0
  201.0000    0.5250   -0.6103         0
  202.0000    0.4250   -0.6103         0
  203.0000    0.3500   -0.7402         0
  204.0000    0.4500   -0.5670         0
  205.0000    0.3750   -0.6969         0
  206.0000    0.5000   -0.5670         0
  207.0000    0.4000   -0.5670         0
  208.0000    0.4250   -0.5237         0
  209.0000    0.5500   -0.5670         0
  210.0000    0.4750   -0.5237         0
  211.0000    0.3750   -0.5237         0
  212.0000    0.5750   -0.6103         0
  213.0000    0.4000   -0.4804         0
  214.0000    0.5250   -0.5237         0
  215.0000    0.4500   -0.4804         0
  216.0000    0.5000   -0.4804         0
  217.0000    0.5750   -0.5237         0
  218.0000    0.5500   -0.4804         0
  219.0000    0.6000   -0.5670         0
  220.0000    0.6250   -0.6103         0
  221.0000    0.6500   -0.5670         0
  222.0000    0.6750   -0.6103         0
  223.0000    0.7250   -0.6103         0
  224.0000    0.5750   -0.4371         0
  225.0000    0.6000   -0.3938         0
  226.0000    0.6500   -0.3938         0
  227.0000    0.5500   -0.3938         0
  228.0000    0.5750   -0.3505         0
  229.0000    0.6250   -0.3505         0
  230.0000    0.5250   -0.3505         0
  231.0000    0.5500   -0.3072         0
  232.0000    0.6000   -0.3072         0
  233.0000    0.5000   -0.3072         0
  234.0000    0.5250   -0.2639         0
  235.0000    0.5750   -0.2639         0
  236.0000    0.4750   -0.2639         0
  237.0000    0.5000   -0.2206         0
  238.0000    0.4500   -0.3072         0
  239.0000    0.5500   -0.2206         0
  240.0000    0.4500   -0.2206         0
  241.0000    0.4250   -0.2639         0
  242.0000    0.4750   -0.1773         0
  243.0000    0.5250   -0.1773         0
  244.0000    0.4250   -0.1773         0
  245.0000    0.5000   -0.1340         0
  246.0000    0.4500   -0.1340         0
  247.0000    0.5500   -0.1340         0
  248.0000    0.5750   -0.1773         0
  249.0000    0.4750   -0.0907         0
  250.0000    0.6000   -0.1340         0
  251.0000    0.5250   -0.0907         0
  252.0000    0.6250   -0.1773         0
  253.0000    0.5750   -0.0907         0
  254.0000    0.6000   -0.2206         0
  255.0000    0.6250   -0.0907         0
  256.0000    0.6500   -0.1340         0
  257.0000    0.6250   -0.2639         0
  258.0000    0.6750   -0.1773         0
  259.0000    0.6500   -0.2206         0
  260.0000    0.6500   -0.3072         0
  261.0000    0.6750   -0.2639         0
  262.0000    0.6750   -0.3505         0
  263.0000    0.7000   -0.3072         0
  264.0000    0.7000   -0.3938         0
  265.0000    0.7250   -0.3505         0
  266.0000    0.7500   -0.3938         0
  267.0000    0.7750   -0.4371         0
  268.0000    0.8000   -0.3938         0
  269.0000    0.8250   -0.4371         0
  270.0000    0.8500   -0.4804         0
  271.0000    0.8750   -0.4371         0
  272.0000    0.9000   -0.4804         0
  273.0000    0.9393   -0.5241         0
  274.0000    0.9562   -0.4788         0
  275.0000    0.4000   -0.6536         0
  276.0000    0.3500   -0.6536         0
  277.0000    0.3750   -0.6103         0
  278.0000    0.3500   -0.5670         0
  279.0000    0.3250   -0.6103         0
  280.0000    0.3000   -0.5670         0
  281.0000    0.3250   -0.5237         0
  282.0000    0.3000   -0.6536         0
  283.0000    0.2750   -0.6103         0
  284.0000    0.2500   -0.6536         0
  285.0000    0.2250   -0.6103         0
  286.0000    0.2750   -0.6969         0
  287.0000    0.2500   -0.5670         0
  288.0000    0.2250   -0.6969         0
  289.0000    0.3250   -0.6969         0
  290.0000    0.2000   -0.6536         0
  291.0000    0.3000   -0.7402         0
  292.0000    0.2750   -0.5237         0
  293.0000    0.2500   -0.7402         0
  294.0000    0.1750   -0.6103         0
  295.0000    0.3000   -0.4804         0
  296.0000    0.2000   -0.5670         0
  297.0000    0.3500   -0.4804         0
  298.0000    0.2500   -0.4804         0
  299.0000    0.2750   -0.4371         0
  300.0000    0.3250   -0.4371         0
  301.0000    0.3750   -0.4371         0
  302.0000    0.4250   -0.4371         0
  303.0000    0.4000   -0.3938         0
  304.0000    0.3500   -0.3938         0
  305.0000    0.4500   -0.3938         0
  306.0000    0.3000   -0.3938         0
  307.0000    0.4750   -0.4371         0
  308.0000    0.3750   -0.3505         0
  309.0000    0.3250   -0.3505         0
  310.0000    0.4250   -0.3505         0
  311.0000    0.4000   -0.3072         0
  312.0000    0.4750   -0.3505         0
  313.0000    0.5000   -0.3938         0
  314.0000    0.5250   -0.4371         0
  315.0000    0.3250   -0.7835         0
  316.0000    0.2750   -0.7835         0
  317.0000    0.3500   -0.8268         0
  318.0000    0.2250   -0.7835         0
  319.0000    0.3000   -0.8268         0
  320.0000    0.4000   -0.8268         0
  321.0000    0.2000   -0.7402         0
  322.0000    0.3250   -0.8701         0
  323.0000    0.2750   -0.8701         0
  324.0000    0.3000   -0.9134         0
  325.0000    0.2500   -0.8268         0
  326.0000    0.2500   -0.9134         0
  327.0000    0.2250   -0.8701         0
  328.0000    0.2000   -0.8268         0
  329.0000    0.2000   -0.9134         0
  330.0000    0.1750   -0.7835         0
  331.0000    0.1750   -0.8701         0
  332.0000    0.1500   -0.7402         0
  333.0000    0.1500   -0.8268         0
  334.0000    0.1750   -0.6969         0
  335.0000    0.1250   -0.7835         0
  336.0000    0.1000   -0.7402         0
  337.0000    0.1250   -0.6969         0
  338.0000    0.1458   -0.6519         0
  339.0000    0.1000   -0.6536         0
  340.0000    0.0750   -0.6969         0
  341.0000    0.0500   -0.6536         0
  342.0000    0.0500   -0.7402         0
  343.0000    0.0708   -0.7862         0
  344.0000    0.1000   -0.8268         0
  345.0000    0.0483   -0.8260         0
  346.0000    0.1250   -0.8701         0
  347.0000    0.0708   -0.8668         0
  348.0000    0.1000   -0.9134         0
  349.0000    0.0500   -0.9134         0
  350.0000    0.0708   -0.9556         0
  351.0000    0.1250   -0.9567         0
  352.0000    0.1500   -0.9134         0
  353.0000    0.1750   -0.9567         0
  354.0000    0.2250   -0.9567         0
  355.0000    0.2250   -0.5237         0
  356.0000    0.2000   -0.4804         0
  357.0000    0.2250   -0.4371         0
  358.0000    0.1607   -0.5241         0
  359.0000    0.1463   -0.4787         0
  360.0000    0.1708   -0.4392         0
  361.0000    0.2000   -0.3938         0
  362.0000    0.2500   -0.3938         0
  363.0000    0.1500   -0.3938         0
  364.0000    0.1750   -0.3505         0
  365.0000    0.2250   -0.3505         0
  366.0000    0.2750   -0.3505         0
  367.0000    0.2500   -0.3072         0
  368.0000    0.3000   -0.3072         0
  369.0000    0.2750   -0.2639         0
  370.0000    0.3250   -0.2639         0
  371.0000    0.2250   -0.2639         0
  372.0000    0.3500   -0.3072         0
  373.0000    0.2500   -0.2206         0
  374.0000    0.3000   -0.2206         0
  375.0000    0.2000   -0.2206         0
  376.0000    0.2750   -0.1773         0
  377.0000    0.2250   -0.1773         0
  378.0000    0.3250   -0.1773         0
  379.0000    0.3500   -0.2206         0
  380.0000    0.2500   -0.1340         0
  381.0000    0.3750   -0.1773         0
  382.0000    0.3000   -0.1340         0
  383.0000    0.3750   -0.2639         0
  384.0000    0.4000   -0.2206         0
  385.0000    0.3500   -0.1340         0
  386.0000    0.3250   -0.0907         0
  387.0000    0.4000   -0.1340         0
  388.0000    0.3750   -0.0907         0
  389.0000    0.4250   -0.0907         0
  390.0000    0.4500   -0.0474         0
  391.0000    0.5000   -0.0474         0
  392.0000    0.4000   -0.0474         0
  393.0000    0.3500   -0.0474         0
  394.0000    0.3000   -0.0474         0
  395.0000    0.2750   -0.9567         0
  396.0000    0.1750   -0.0433         0
  397.0000    0.1250   -0.0433         0
  398.0000    0.2250   -0.0433         0
  399.0000    0.1500   -0.0866         0
  400.0000    0.2000   -0.0866         0
  401.0000    0.1000   -0.0866         0
  402.0000    0.2500   -0.0866         0
  403.0000    0.1250   -0.1299         0
  404.0000    0.0607   -0.1285         0
  405.0000    0.1750   -0.1299         0
  406.0000    0.0500   -0.0866         0
  407.0000    0.0937   -0.1862         0
  408.0000    0.1500   -0.1732         0
  409.0000    0.0708   -0.0444         0
  410.0000    0.0395   -0.1779         0
  411.0000    0.6750   -0.7835         0
  412.0000    0.7250   -0.7835         0
  413.0000    0.4750   -0.7835         0
  414.0000    0.7750   -0.7835         0
  415.0000    0.5750   -0.0433         0
  416.0000    0.6250   -0.0433         0
  417.0000    0.6750   -0.0433         0
  418.0000    0.7250   -0.0433         0
  419.0000    0.7000   -0.0866         0
  420.0000    0.7500   -0.0866         0
  421.0000    0.7750   -0.0433         0
  422.0000    0.7250   -0.1299         0
  423.0000    0.7750   -0.1299         0
  424.0000    0.8000   -0.0866         0
  425.0000    0.7500   -0.1732         0
  426.0000    0.8250   -0.0433         0
  427.0000    0.8250   -0.1299         0
  428.0000    0.8500   -0.0866         0
  429.0000    0.8750   -0.0433         0
  430.0000    0.8750   -0.1299         0
  431.0000    0.8500   -0.1732         0
  432.0000    0.8000   -0.1732         0
  433.0000    0.9000   -0.1732         0
  434.0000    0.9292   -0.0444         0
  435.0000    0.8750   -0.2165         0
  436.0000    0.9393   -0.1285         0
  437.0000    0.9000   -0.0866         0
  438.0000    0.8250   -0.2165         0
  439.0000    0.9292   -0.2138         0
  440.0000    0.9537   -0.1731         0
  441.0000    0.9000   -0.2598         0
  442.0000    0.7750   -0.2165         0
  443.0000    0.8500   -0.2598         0
  444.0000    0.9500   -0.2598         0
  445.0000    0.9250   -0.3031         0
  446.0000    0.7250   -0.2165         0
  447.0000    0.8000   -0.2598         0
  448.0000    0.8750   -0.3031         0
  449.0000    0.8250   -0.3031         0
  450.0000    0.7500   -0.2598         0
  451.0000    0.7750   -0.3031         0
  452.0000    0.8500   -0.3464         0
  453.0000    0.8000   -0.3464         0
  454.0000    0.9500   -0.0866         0
  455.0000    0.9000   -0.3464         0
  456.0000    0.8750   -0.3897         0
  457.0000    0.9236   -0.3932         0
  458.0000    0.9500   -0.3464         0
  459.0000    0.0433   -0.2250         0
  460.0000    0.0433   -0.2750         0
  461.0000    0.0895   -0.2475         0
  462.0000    0.0444   -0.3292         0
  463.0000    0.0866   -0.3000         0
  464.0000    0.1299   -0.2750         0
  465.0000    0.0866   -0.3500         0
  466.0000    0.1358   -0.3287         0
  467.0000    0.1399   -0.2237         0
  468.0000    0.1732   -0.2500         0
  469.0000    0.1869   -0.3031         0
  470.0000    0.1500   -0.5670         0
  471.0000    0.9417   -0.4396         0
];

%% Conectivities
% Element        Node(1)                Node(2)                Node(3)                Material

connec = [
  1     1     9    84     0
     2    35    36    85     0
     3     8    66    65     0
     4    85    36    86     0
     5    35    85    87     0
     6    86    36    37     0
     7    87    85    88     0
     8    35    87    34     0
     9    88    85    89     0
    10    87    88    90     0
    11    34    87    91     0
    12    88    89    92     0
    13    90    88    93     0
    14    91    87    90     0
    15    92    89    94     0
    16    93    88    92     0
    17    94    89    95     0
    18    92    94    96     0
    19    95    89    86     0
    20    94    95    97     0
    21    96    94    98     0
    22    86    89    85     0
    23    97    95    99     0
    24    98    94    97     0
    25    97    99   100     0
    26   100    99   101     0
    27    97   100   102     0
    28   101    99   103     0
    29   102   100   104     0
    30    97   102    98     0
    31   103    99   105     0
    32   104   100   106     0
    33    98   102   107     0
    34   103   105    38     0
    35   106   100   101     0
    36   107   102   108     0
    37    38   105    37     0
    38   106   101   109     0
    39   108   102   104     0
    40    37   105    86     0
    41   109   101   110     0
    42   108   104   111     0
    43    86   105    95     0
    44   110   101   103     0
    45   111   104   112     0
    46    95   105    99     0
    47   110   103    39     0
    48   112   104   106     0
    49   110    39    40     0
    50   110    40   113     0
    51   113    40    41     0
    52   110   113   109     0
    53   113    41   114     0
    54   109   113   115     0
    55   114    41    42     0
    56   115   113   114     0
    57   114    42   116     0
    58   115   114   117     0
    59   116    42    43     0
    60   117   114   116     0
    61   115   117   118     0
    62   116    43   119     0
    63   118   117   120     0
    64   115   118   121     0
    65   119    43    44     0
    66   120   117   122     0
    67   121   118   123     0
    68   119    44   124     0
    69   122   117   116     0
    70   123   118   125     0
    71   124    44    45     0
    72   122   116   119     0
    73   125   118   120     0
    74   124    45   126     0
    75   125   120   127     0
    76   126    45    46     0
    77   124   126   128     0
    78   127   120   129     0
    79   126    46    47     0
    80   128   126   130     0
    81   129   120   122     0
    82   130   126    47     0
    83   128   130   131     0
    84   129   122   132     0
    85   131   130    49     0
    86   128   131   133     0
    87   132   122   119     0
    88   133   131   134     0
    89   128   133   132     0
    90   132   119   124     0
    91   134   131   135     0
    92   132   133   129     0
    93   128   132   124     0
    94   135   131    49     0
    95   134   135   136     0
    96   129   133   137     0
    97   136   135    50     0
    98   134   136   138     0
    99   137   133   134     0
   100   138   136   139     0
   101   134   138   137     0
   102   139   136   140     0
   103   137   138   141     0
   104   140   136    50     0
   105   139   140   142     0
   106   141   138   143     0
   107   142   140    52     0
   108   139   142   144     0
   109   143   138   139     0
   110   144   142   145     0
   111   139   144   143     0
   112   145   142   146     0
   113   143   144   147     0
   114   146   142    52     0
   115   145   146   148     0
   116   147   144   149     0
   117   143   147   150     0
   118   148   146    54     0
   119   145   148   151     0
   120   149   144   145     0
   121   150   147   152     0
   122   151   148   153     0
   123   145   151   149     0
   124   152   147   154     0
   125   150   152   155     0
   126   153   148   156     0
   127   149   151   157     0
   128   154   147   149     0
   129   155   152   158     0
   130   156   148    54     0
   131   157   151   159     0
   132   158   152   160     0
   133   155   158   161     0
   134   159   151   153     0
   135   157   159   162     0
   136   160   152   154     0
   137   161   158   163     0
   138   162   159   164     0
   139   157   162   165     0
   140   163   158   166     0
   141   161   163   167     0
   142   164   159   168     0
   143   165   162   169     0
   144   166   158   160     0
   145   167   163   170     0
   146   168   159   153     0
   147   169   162   171     0
   148   170   163   172     0
   149   167   170   173     0
   150   171   162   164     0
   151   169   171   174     0
   152   172   163   166     0
   153   173   170   175     0
   154   174   171   176     0
   155   169   174   177     0
   156   175   170   178     0
   157   173   175   179     0
   158   176   171   180     0
   159   177   174   181     0
   160   178   170   172     0
   161   179   175   182     0
   162   180   171   164     0
   163   181   174   183     0
   164   182   175   184     0
   165   179   182   185     0
   166   183   174   176     0
   167   181   183   186     0
   168   184   175   178     0
   169   185   182   187     0
   170   186   183   188     0
   171   181   186   189     0
   172   187   182   190     0
   173   185   187   191     0
   174   188   183   192     0
   175   189   186   193     0
   176   190   182   184     0
   177   191   187   194     0
   178   192   183   176     0
   179   193   186   195     0
   180   194   187   196     0
   181   191   194   197     0
   182   195   186   188     0
   183   196   187   190     0
   184   191   197   198     0
   185   196   190   199     0
   186   198   197   200     0
   187   199   190   201     0
   188   196   199   202     0
   189   200   197   203     0
   190   201   190   184     0
   191   202   199   204     0
   192   203   197   205     0
   193   204   199   206     0
   194   202   204   207     0
   195   205   197   194     0
   196   206   199   201     0
   197   207   204   208     0
   198   206   201   209     0
   199   208   204   210     0
   200   207   208   211     0
   201   209   201   212     0
   202   210   204   206     0
   203   211   208   213     0
   204   212   201   184     0
   205   210   206   214     0
   206   213   208   215     0
   207   214   206   209     0
   208   210   214   216     0
   209   215   208   210     0
   210   214   209   217     0
   211   216   214   218     0
   212   215   210   216     0
   213   217   209   219     0
   214   218   214   217     0
   215   219   209   212     0
   216   217   219   189     0
   217   218   217   193     0
   218   219   212   220     0
   219   189   219   221     0
   220   193   217   189     0
   221   220   212   178     0
   222   221   219   220     0
   223   178   212   184     0
   224   221   220   222     0
   225   222   220   172     0
   226   172   220   178     0
   227   222   172   166     0
   228   222   166   223     0
   229   223   166   160     0
   230   223   160   165     0
   231   165   160   154     0
   232   165   154   157     0
   233   157   154   149     0
   234   193   195   224     0
   235   224   195   225     0
   236   225   195   226     0
   237   224   225   227     0
   238   226   195   188     0
   239   227   225   228     0
   240   228   225   229     0
   241   227   228   230     0
   242   229   225   226     0
   243   230   228   231     0
   244   231   228   232     0
   245   230   231   233     0
   246   232   228   229     0
   247   233   231   234     0
   248   234   231   235     0
   249   233   234   236     0
   250   235   231   232     0
   251   236   234   237     0
   252   233   236   238     0
   253   237   234   239     0
   254   236   237   240     0
   255   238   236   241     0
   256   239   234   235     0
   257   240   237   242     0
   258   241   236   240     0
   259   242   237   243     0
   260   240   242   244     0
   261   243   237   239     0
   262   242   243   245     0
   263   244   242   246     0
   264   245   243   247     0
   265   242   245   246     0
   266   247   243   248     0
   267   246   245   249     0
   268   248   243   239     0
   269   247   248   250     0
   270   249   245   251     0
   271   250   248   252     0
   272   247   250   253     0
   273   251   245   247     0
   274   252   248   254     0
   275   253   250   255     0
   276   251   247   253     0
   277   254   248   239     0
   278   255   250   256     0
   279   254   239   235     0
   280   256   250   252     0
   281   254   235   257     0
   282   256   252   258     0
   283   257   235   232     0
   284   258   252   259     0
   285   257   232   260     0
   286   259   252   254     0
   287   260   232   229     0
   288   257   260   261     0
   289   260   229   262     0
   290   261   260   263     0
   291   262   229   226     0
   292   260   262   263     0
   293   262   226   264     0
   294   263   262   265     0
   295   264   226   188     0
   296   262   264   265     0
   297   264   188   192     0
   298   265   264   266     0
   299   264   192   266     0
   300   266   192   267     0
   301   267   192   176     0
   302   266   267   268     0
   303   267   176   180     0
   304   268   267   269     0
   305   267   180   269     0
   306   269   180   270     0
   307   270   180   164     0
   308   269   270   271     0
   309   270   164   168     0
   310   271   270   272     0
   311   270   168   272     0
   312   272   168   273     0
   313   273   168   153     0
   314   272   273   274     0
   315   273   153   156     0
   316   274   273    56     0
   317   273    55    56     0
   318   205   194   275     0
   319   275   194   196     0
   320   205   275   276     0
   321   275   196   202     0
   322   276   275   277     0
   323   275   202   277     0
   324   277   202   207     0
   325   277   207   278     0
   326   278   207   211     0
   327   277   278   279     0
   328   279   278   280     0
   329   277   279   276     0
   330   280   278   281     0
   331   276   279   282     0
   332   281   278   211     0
   333   282   279   283     0
   334   283   279   280     0
   335   282   283   284     0
   336   284   283   285     0
   337   282   284   286     0
   338   285   283   287     0
   339   286   284   288     0
   340   282   286   289     0
   341   287   283   280     0
   342   288   284   290     0
   343   289   286   291     0
   344   287   280   292     0
   345   290   284   285     0
   346   291   286   293     0
   347   292   280   281     0
   348   290   285   294     0
   349   293   286   288     0
   350   292   281   295     0
   351   294   285   296     0
   352   295   281   297     0
   353   292   295   298     0
   354   296   285   287     0
   355   297   281   211     0
   356   298   295   299     0
   357   297   211   213     0
   358   299   295   300     0
   359   297   213   301     0
   360   300   295   297     0
   361   301   213   302     0
   362   297   301   300     0
   363   302   213   215     0
   364   301   302   303     0
   365   300   301   304     0
   366   303   302   305     0
   367   304   301   303     0
   368   300   304   306     0
   369   305   302   307     0
   370   304   303   308     0
   371   306   304   309     0
   372   307   302   215     0
   373   308   303   310     0
   374   309   304   308     0
   375   310   303   305     0
   376   308   310   311     0
   377   310   305   312     0
   378   311   310   238     0
   379   312   305   313     0
   380   310   312   238     0
   381   313   305   307     0
   382   238   312   233     0
   383   313   307   314     0
   384   233   312   230     0
   385   314   307   216     0
   386   313   314   227     0
   387   230   312   313     0
   388   314   216   218     0
   389   227   314   224     0
   390   314   218   224     0
   391   224   218   193     0
   392   227   230   313     0
   393   276   282   289     0
   394   276   289   205     0
   395   205   289   203     0
   396   203   289   291     0
   397   203   291   315     0
   398   315   291   316     0
   399   203   315   200     0
   400   316   291   293     0
   401   200   315   317     0
   402   316   293   318     0
   403   317   315   319     0
   404   200   317   320     0
   405   318   293   321     0
   406   319   315   316     0
   407   320   317    93     0
   408   321   293   288     0
   409    93   317   322     0
   410   320    93    92     0
   411   322   317   319     0
   412    93   322    90     0
   413   322   319   323     0
   414    90   322   324     0
   415   323   319   325     0
   416   322   323   324     0
   417   325   319   316     0
   418   324   323   326     0
   419   325   316   318     0
   420   326   323   327     0
   421   325   318   328     0
   422   327   323   325     0
   423   326   327   329     0
   424   328   318   330     0
   425   327   325   328     0
   426   329   327   331     0
   427   330   318   321     0
   428   327   328   331     0
   429   330   321   332     0
   430   331   328   333     0
   431   332   321   334     0
   432   330   332   335     0
   433   333   328   330     0
   434   334   321   288     0
   435   335   332   336     0
   436   333   330   335     0
   437   334   288   290     0
   438   336   332   337     0
   439   334   290   338     0
   440   337   332   334     0
   441   338   290   294     0
   442   334   338   337     0
   443   338   294     4     0
   444   337   338   339     0
   445   339   338     4     0
   446   337   339   340     0
   447   340   339   341     0
   448   337   340   336     0
   449   341   339     4     0
   450   340   341    22     0
   451   336   340   342     0
   452   342   340    22     0
   453   336   342   343     0
   454   343   342    24     0
   455   336   343   335     0
   456   335   343   344     0
   457   344   343   345     0
   458   335   344   333     0
   459   345   343    24     0
   460   333   344   346     0
   461   346   344   347     0
   462   347   344   345     0
   463   346   347   348     0
   464   347   345    25     0
   465   348   347   349     0
   466   349   347    25     0
   467   348   349   350     0
   468   350   349    27     0
   469   348   350   351     0
   470   351   350    29     0
   471   348   351   352     0
   472    29   350    28     0
   473   352   351   353     0
   474   348   352   346     0
   475    28   350    27     0
   476   352   353   329     0
   477   346   352   331     0
   478   329   353   354     0
   479   331   352   329     0
   480   346   331   333     0
   481   354   353    31     0
   482    31   353    30     0
   483   354    31    32     0
   484    30   353   351     0
   485    30   351    29     0
   486   292   298   355     0
   487   355   298   356     0
   488   292   355   287     0
   489   356   298   357     0
   490   287   355   296     0
   491   357   298   299     0
   492   296   355   358     0
   493   358   355   356     0
   494   358   356   359     0
   495   359   356   360     0
   496   358   359    18     0
   497   360   356   357     0
   498   360   357   361     0
   499   361   357   362     0
   500   360   361   363     0
   501   362   357   299     0
   502   363   361   364     0
   503   362   299   306     0
   504   364   361   365     0
   505   306   299   300     0
   506   365   361   362     0
   507   365   362   366     0
   508   366   362   306     0
   509   365   366   367     0
   510   366   306   309     0
   511   367   366   368     0
   512   368   366   309     0
   513   367   368   369     0
   514   369   368   370     0
   515   367   369   371     0
   516   370   368   372     0
   517   371   369   373     0
   518   372   368   309     0
   519   373   369   374     0
   520   371   373   375     0
   521   374   369   370     0
   522   373   374   376     0
   523   375   373   377     0
   524   376   374   378     0
   525   373   376   377     0
   526   378   374   379     0
   527   377   376   380     0
   528   379   374   370     0
   529   378   379   381     0
   530   380   376   382     0
   531   379   370   383     0
   532   381   379   384     0
   533   382   376   378     0
   534   383   370   372     0
   535   384   379   383     0
   536   382   378   385     0
   537   384   383   241     0
   538   385   378   381     0
   539   382   385   386     0
   540   241   383   311     0
   541   385   381   387     0
   542   386   385   388     0
   543   311   383   372     0
   544   387   381   244     0
   545   388   385   387     0
   546   311   372   308     0
   547   244   381   384     0
   548   388   387   389     0
   549   308   372   309     0
   550   244   384   240     0
   551   389   387   246     0
   552   240   384   241     0
   553   246   387   244     0
   554   389   246   249     0
   555   389   249   390     0
   556   390   249   391     0
   557   389   390   392     0
   558   391   249   251     0
   559   392   390    76     0
   560    76   390    75     0
   561   389   392   388     0
   562   388   392   393     0
   563   393   392    77     0
   564    77   392    76     0
   565   388   393   386     0
   566   386   393   394     0
   567   394   393    78     0
   568    78   393    77     0
   569   324   326   395     0
   570   395   326   354     0
   571   324   395    91     0
   572   354   326   329     0
   573    91   395    33     0
   574    33   395    32     0
   575    91    33    34     0
   576    32   395   354     0
   577   359   360    17     0
   578     5    21    20     0
   579    81    82   396     0
   580   396    82   397     0
   581    81   396   398     0
   582   397    82    83     0
   583   396   397   399     0
   584   398   396   400     0
   585    81   398    80     0
   586   399   397   401     0
   587   398   400   402     0
   588    80   398   394     0
   589   399   401   403     0
   590   402   400   380     0
   591   402   380   382     0
   592   403   401   404     0
   593   399   403   405     0
   594   404   401   406     0
   595   403   404   407     0
   596   405   403   408     0
   597   406   401   409     0
   598   407   404   410     0
   599   408   403   407     0
   600   409   401   397     0
   601   410   404    11     0
   602   409   397    83     0
   603   409    83    84     0
   604   409    84     9     0
   605   400   396   399     0
   606   400   399   405     0
   607   400   405   380     0
   608   238   241   311     0
   609   405   408   377     0
   610    50    51   140     0
   611   167   173   111     0
   612   111   173   108     0
   613   167   111   411     0
   614   108   173   179     0
   615   411   111   112     0
   616   167   411   161     0
   617   108   179   107     0
   618   411   112   123     0
   619   161   411   412     0
   620   107   179   185     0
   621   411   123   412     0
   622   161   412   155     0
   623   107   185   413     0
   624   412   123   125     0
   625   413   185   191     0
   626   107   413    98     0
   627   412   125   414     0
   628   413   191   198     0
   629    98   413    96     0
   630   414   125   127     0
   631   413   198    96     0
   632   414   127   141     0
   633    96   198   320     0
   634   141   127   137     0
   635   414   141   150     0
   636   320   198   200     0
   637    96   320    92     0
   638   137   127   129     0
   639   150   141   143     0
   640   123   112   121     0
   641   121   112   106     0
   642   121   106   109     0
   643   121   109   115     0
   644   155   412   414     0
   645   155   414   150     0
   646     2    16    15     0
   647    73    74   415     0
   648   415    74   391     0
   649    73   415   416     0
   650   416   415   253     0
   651   253   415   251     0
   652    73   416    72     0
   653    72   416   417     0
   654   417   416   255     0
   655   255   416   253     0
   656    72   417    71     0
   657    71   417   418     0
   658   418   417   419     0
   659    71   418    70     0
   660   419   417   255     0
   661   418   419   420     0
   662    70   418   421     0
   663   420   419   422     0
   664   418   420   421     0
   665   422   419   256     0
   666   420   422   423     0
   667   421   420   424     0
   668   423   422   425     0
   669   420   423   424     0
   670   421   424   426     0
   671   425   422   258     0
   672   424   423   427     0
   673   426   424   428     0
   674   421   426    69     0
   675   424   427   428     0
   676   426   428   429     0
   677    69   426    68     0
   678   428   427   430     0
   679   426   429    68     0
   680   430   427   431     0
   681    68   429    67     0
   682   431   427   432     0
   683   430   431   433     0
   684    67   429   434     0
   685   432   427   423     0
   686   433   431   435     0
   687   430   433   436     0
   688   434   429   437     0
   689   435   431   438     0
   690   433   435   439     0
   691   436   433   440     0
   692   437   429   428     0
   693   438   431   432     0
   694   439   435   441     0
   695   440   433   439     0
   696   438   432   442     0
   697   441   435   443     0
   698   439   441   444     0
   699   440   439    62     0
   700   442   432   425     0
   701   443   435   438     0
   702   444   441   445     0
   703   425   432   423     0
   704   442   425   446     0
   705   443   438   447     0
   706   445   441   448     0
   707   446   425   258     0
   708   447   438   442     0
   709   443   447   449     0
   710   448   441   443     0
   711   447   442   450     0
   712   449   447   451     0
   713   443   449   448     0
   714   450   442   446     0
   715   451   447   450     0
   716   448   449   452     0
   717   450   446   261     0
   718   451   450   263     0
   719   452   449   453     0
   720   453   449   451     0
   721   452   453   268     0
   722   268   453   266     0
   723   453   451   265     0
   724   428   430   437     0
   725   437   430   436     0
   726   437   436   454     0
   727   454   436    64     0
   728   437   454   434     0
   729   434   454    65     0
   730   448   452   455     0
   731   455   452   456     0
   732   448   455   445     0
   733   456   452   268     0
   734   455   456   457     0
   735   445   455   458     0
   736   457   456   271     0
   737   271   456   269     0
   738   455   457   458     0
   739   445   458    60     0
   740   458   457    58     0
   741    70   421    69     0
   742     6    28    27     0
   743    58    59   458     0
   744    12    13   459     0
   745   459    13   460     0
   746    12   459   410     0
   747   460    13    14     0
   748   459   460   461     0
   749   460    14   462     0
   750   461   460   463     0
   751   459   461   407     0
   752   460   462   463     0
   753   461   463   464     0
   754   463   462   465     0
   755   464   463   466     0
   756   465   462    16     0
   757   463   465   466     0
   758   466   465   363     0
   759   462    14    15     0
   760   462    15    16     0
   761   461   464   467     0
   762   467   464   468     0
   763   461   467   407     0
   764   468   464   469     0
   765   469   464   466     0
   766   468   469   371     0
   767   469   466   364     0
   768   467   468   375     0
   769   375   468   371     0
   770   382   386   402     0
   771    67   434    66     0
   772    66   434    65     0
   773    24    25   345     0
   774   390   391    75     0
   775    75   391    74     0
   776    54    55   156     0
   777    18    19   358     0
   778   324    91    90     0
   779   404    10    11     0
   780     7    47    46     0
   781   377   380   405     0
   782   444   445    60     0
   783    62    63   440     0
   784    10   404   406     0
   785   215   216   307     0
   786   436   440    63     0
   787    22    23   342     0
   788   407   410   459     0
   789    52    53   146     0
   790   169   177   223     0
   791   223   177   222     0
   792   169   223   165     0
   793   222   177   221     0
   794   221   177   181     0
   795   221   181   189     0
   796     3    17   363     0
   797   365   367   469     0
   798   375   377   408     0
   799    60    61   444     0
   800   367   371   469     0
   801    26    27   349     0
   802   254   257   259     0
   803   259   257   261     0
   804   259   261   446     0
   805    56    57   274     0
   806     4    20   341     0
   807    79    80   394     0
   808    79   394    78     0
   809    48    49   130     0
   810   294   296   470     0
   811   470   296   358     0
   812   294   470     4     0
   813   470   358    19     0
   814    64    65   454     0
   815   255   256   419     0
   816     9    10   406     0
   817   263   265   451     0
   818    21    22   341     0
   819   406   409     9     0
   820    51    52   140     0
   821    16     3   465     0
   822   258   259   446     0
   823   261   263   450     0
   824    59    60   458     0
   825   363   364   466     0
   826    25    26   349     0
   827   360   363    17     0
   828    55   273   156     0
   829   268   269   456     0
   830    19     4   470     0
   831   398   402   394     0
   832    47    48   130     0
   833   271   272   471     0
   834   471   272   274     0
   835   271   471   457     0
   836   457   471    58     0
   837   471   274    57     0
   838    63    64   436     0
   839   265   266   453     0
   840    11    12   410     0
   841   391   251   415     0
   842    38    39   103     0
   843    23    24   342     0
   844    53    54   146     0
   845    17    18   359     0
   846   386   394   402     0
   847   256   258   422     0
   848    61    62   444     0
   849   364   365   469     0
   850    57    58   471     0
   851   408   407   467     0
   852    49    50   135     0
   853   439   444    62     0
   854    21   341    20     0
   855     3   363   465     0
   856   408   467   375     0
];

%% Variable Prescribed
% Node            Dimension                Value

dirichlet_data = [
56 1 0 
56 2 0 
18 2 0 
];

%% Force Prescribed
% Node                Dimension                Value

pointload_complete = [
2 1 0 
2 2 1 
3 1 0 
3 2 1 
4 1 0 
4 2 -1 
5 1 0 
5 2 -1 
7 1 0 
7 2 10 
8 1 0 
8 2 -10 
16 1 0 
16 2 1 
20 1 0 
20 2 -1 
44 1 0 
44 2 10 
45 1 0 
45 2 10 
46 1 0 
46 2 10 
66 1 0 
66 2 -10 
67 1 0 
67 2 -10 
68 1 0 
68 2 -10 
];

pointload_adjoint = [
2 1 0 
2 2 2 
3 1 0 
3 2 2
4 1 0 
4 2 -2 
5 1 0 
5 2 -2 
7 1 0 
7 2 1 
8 1 0 
8 2 -1 
16 1 0 
16 2 2
20 1 0 
20 2 -2
44 1 0 
44 2 1
45 1 0 
45 2 1 
46 1 0 
46 2 1
66 1 0 
66 2 -1 
67 1 0 
67 2 -1 
68 1 0 
68 2 -1
];

%% Volumetric Force
% Element        Dim                Force_Dim

Vol_force = [
];

%% Group Elements
% Element        Group_num

Group = [
];

%% Initial Holes
% Elements that are considered holes initially
% Element

Initial_holes = [
];

%% Boundary Elements
% Elements that can not be removed
% Element

Boundary_elements = [
];

%% Micro gauss post
%
% Element

Micro_gauss_post = [
];


%% Micro Slave-Master
% Nodes that are Slaves
% Nodes             Value (1-Slave,0-Master)

Micro_slave = [
];

%% Nodes solid
% Nodes that must remain 
% Nodes

nodesolid = unique(pointload_complete(:,1));

%% External border Elements
% Detect the elements that define the edge of the domain
% Element               Node(1)           Node(2)

External_border_elements = [
];

%% External border Nodes
% Detect the nodes that define the edge of the domain
% Node

External_border_nodes = [
];

%% Materials
% Materials that have been used
% Material_Num              Mat_density        Young_Modulus        Poisson

Materials = [
];
